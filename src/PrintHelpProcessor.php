<?php

namespace Perk11\Viktor89;

use Perk11\Viktor89\IPC\ProgressUpdateCallback;

class PrintHelpProcessor implements MessageChainProcessor
{
    private const COMMANDS = [
        '/image' => '–ì–µ–Ω–µ—Ä–∞—Ü–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä <code>/image a cute cat curling in a ball</code>.',
        '/imagine' => '–ê–Ω–∞–ª–æ–≥ /image, –Ω–æ —Ç–µ–∫—Å—Ç –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω LLM –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —è–∑—ã–∫–æ–≤.',
        '/rmbg' => '–£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.',
        '/imagemodel' => '–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è',
        '/e' =>  '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ –∏–ª–∏ —Ñ–∞–π–ª.',
        '/edit' => '–¢–æ–∂–µ —á—Ç–æ e, –Ω–æ –∑–∞–ø—Ä–æ—Å –ø—Ä–æ–π–¥—ë—Ç —á–µ—Ä–µ–∑ LLM.',
        '/editmodel' => '–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è /e –∏ /edit',
        '/imagesize' => '–†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ù–µ –≤—Å–µ –º–æ–¥–µ–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏',
        '/steps' => '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä <code>/steps 20</code>. –ß–µ–º –±–æ–ª—å—à–µ —à–∞–≥–æ–≤, —Ç–µ–º –¥–æ–ª—å—à–µ –∑–∞–Ω–∏–º–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—è. –ö–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ —Å–≤–æ—ë –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–µ–Ω—è—Ç—å –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –º–æ–¥–µ–ª–∏. –ß—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ <code>/steps</code> –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤',
        '/upscale' => '–£–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ.',
        '/downscale' => '–£—Ö—É–¥—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ.',
        '/video' => '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ. –¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–∞. –ù–∞–ø—Ä–∏–º–µ—Ä: <code>/video A spaceship landing on Venus</code>. –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ, —Ç–æ —Ñ–æ—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –∫–∞–¥—Ä–∞ –¥–ª—è –≤–∏–¥–µ–æ. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫. –ó–∞–Ω–∏–º–∞–µ—Ç –æ—Ç 8 –¥–æ 20 –º–∏–Ω—É—Ç.',
        '/vid' => '–ê–Ω–∞–ª–æ–≥ /video, –Ω–æ —Ç–µ–∫—Å—Ç –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω LLM –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π. –ü–µ—Ä–≤—ã–π –∫–∞–¥—Ä –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å –ø–æ–º–æ—â—å—é flux –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —è–∑—ã–∫–æ–≤.',
        '/vo' => '–°–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—É–¥–∏–æ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.',
        '/videomodel' => '–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ.',
        '/img2videomodel' => '–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è /vid, /video –∫–æ–≥–¥–∞ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ, –∏ –¥–ª—è /vo',
        '/seed' => '–ü–µ—Ä–≤–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞. –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è /image –∏ /video –ù–∞–ø—Ä–∏–º–µ—Ä: <code>/seed 123</code>. –û—Ç–ø—Ä–∞–≤—å—Ç–µ /seed –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.',
        '/say' => '–¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—á–∏. –ù–∞–ø—Ä–∏–º–µ—Ä: <code>/say –Ø –í–∏–∫—Ç–æ—Ä89!</code>',
        '/saymodel' => '–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∏ –≥–æ–ª–æ—Å–∞ –¥–ª—è say',
        '/podcast' => '—Å–æ–∑–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ-–¥–∏–∞–ª–æ–≥–∞ –º–µ–∂–¥—É –¥–≤—É–º—è —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞–º–∏',
        '/transcribe' => '–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫—Ä—É–∂–æ–∫, –≤–∏–¥–µ–æ, –∏–ª–∏ –∞—É–¥–∏–æ —á—Ç–æ–±—ã —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –µ–≥–æ.',
        '/clownon' => '<span class="tg-spoiler">–í–∫–ª—é—á–∏—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º –∫–ª–æ—É–Ω–∞.</span>',
        '/clownify' => '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ —Å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º –ª–∏—Ü–æ–º.',
        '/preferences' => '–ü–æ–∫–∞–∑–∞—Ç—å –≤–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.',
        '/assistant' => '–ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ —Å LLM. –ù–∞–ø—Ä–∏–º–µ—Ä: <code>/assistant –ü—Ä–∏–≤–µ—Ç</code>. –ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—â–µ–Ω–∏–µ, –æ—Ç–≤–µ—á–∞–π—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞.',
        '/assistantmodel' => '–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ LLM.',
        '/systemprompt' => '–£–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è LLM –æ —Ç–æ–º —á—Ç–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä: <code>/systemprompt You are a heartless and mean robot</code>. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: <code>Always respond to the user in the language they use or request.</code>. –û—Ç–ø—Ä–∞–≤—å—Ç–µ /systemprompt –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.',
    ];

    public function processMessageChain(MessageChain $messageChain, ProgressUpdateCallback $progressUpdateCallback): ProcessingResult
    {
        $message = InternalMessage::asResponseTo($messageChain->last());
        $message->messageText = "–ü—Ä–∏–≤–µ—Ç, —è –í–∏–∫—Ç–æ—Ä89.\n
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ–≥–æ-–ª–∏–±–æ –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–≥–æ, –∞ —Ç–∞–∫ –∂–µ –Ω–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å –º–µ–Ω—è –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å.\n
<b><u>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</u></b>\n";
        $message->parseMode = 'HTML';
        foreach (self::COMMANDS as $command => $description) {
            if (mb_strlen($message->messageText) + mb_strlen($description) >= 4000) {
                $message->send();
                $message = InternalMessage::asResponseTo($messageChain->last(), '');
                $message->parseMode = 'HTML';
            }
            $message->messageText .= "<b>" . htmlentities($command) . "</b> $description\n\n";
        }

        $message->messageText .= htmlspecialchars('–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏, –∞ –∑–Ω–∞—á–∏—Ç –±–æ—Ç –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–∑—É –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –≤–∞—à–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –ï—Å–ª–∏ –±–æ—Ç –ø–æ—Å—Ç–∞–≤–∏–ª —Ä–µ–∞–∫—Ü–∏—é "üëÄ", –∑–Ω–∞—á–∏—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω.');
        $message->send();
        return new ProcessingResult(null, true);
    }
}
